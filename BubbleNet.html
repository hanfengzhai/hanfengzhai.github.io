<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
<title>Hanfeng Zhai</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="Fluid Mechanics, Applied Mathematics" />
  
  
  
  
  <meta name="description" content="BubbleNetA deep learning framework for inferring microbubble dynamics Hanfeng Zhai &amp; Guohui Hu [Code] | [Paper] | [Video]      Backgrounds &amp; IntroductionMachine learning (ML) has ac">
<meta property="og:type" content="website">
<meta property="og:title" content="Hanfeng Zhai">
<meta property="og:url" content="www.hanfengzhai.net/BubbleNet.html">
<meta property="og:site_name" content="Hanfeng Zhai">
<meta property="og:description" content="BubbleNetA deep learning framework for inferring microbubble dynamics Hanfeng Zhai &amp; Guohui Hu [Code] | [Paper] | [Video]      Backgrounds &amp; IntroductionMachine learning (ML) has ac">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="/assets/img/bubblenetavatar.jpg">
<meta property="og:image" content="https://zenodo.org/badge/DOI/10.5281/zenodo.4769081.svg">
<meta property="og:image" content="http://img.shields.io/badge/physics.flu_dyn-arXiv%3A2105.07179-B31B1B.svg">
<meta property="og:image" content="/assets/img/bubblenet.jpeg">
<meta property="og:image" content="/assets/img/bubblenet-1.jpeg">
<meta property="og:image" content="/assets/img/bubblenet-2.jpeg">
<meta property="article:published_time" content="2019-11-29T16:00:00.000Z">
<meta property="article:modified_time" content="2021-05-20T06:08:23.811Z">
<meta property="article:author" content="Bachelor Student @ Shanghai University">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/assets/img/bubblenetavatar.jpg">
  
    <link rel="alternate" href="/atom.xml" title="Hanfeng Zhai" type="application/atom+xml">
  

  

  <link rel="icon" href="/css/images/avatar.jpg">
  <link rel="apple-touch-icon" href="/css/images/avatar.jpg">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt; src:url("/css/fonts/FuturaPTBold.otf") format("woff");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt-light; src:url("/css/fonts/FuturaPTBook.otf") format("woff");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt-italic; src:url("/css/fonts/FuturaPTBookOblique.otf") format("woff");font-weight:400;font-style:italic;}
}

  </style>
  
<link rel="stylesheet" href="/css/style.css">


  
<script src="/js/jquery-3.1.1.min.js"></script>

  
<script src="/js/bootstrap.js"></script>


  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >

  
    
<link rel="stylesheet" href="/css/dialog.css">

  

  

  
    <link rel="stylesheet" href="/css/header-post.css" >
  

  
    <link rel="stylesheet" href="/css/archive.css" >
  
  
  

</head>



  <body>


  
  <div id="container">
    <div id="wrap">
      
        <header>

    <div id="allheader" class="navbar navbar-default navbar-static-top" role="navigation">
        <div class="navbar-inner">
          
          <div class="container"> 
            

            
              <a class="brand" style="
                 margin-top: 0px;"  
                 >
                  <img width="124px" height="124px" alt="Hike News" src="/css/images/avatar.jpg">
              </a>
            
            
            
            <div class="navbar-collapse collapse">
              <ul class="hnav navbar-nav">
                
                  <li> <a class="main-nav-link" href="/">hοme</a> </li>
                
                  <li> <a class="main-nav-link" href="/about">abοut</a> </li>
                
                  <li> <a class="main-nav-link" href="/research">research</a> </li>
                
                  <li> <a class="main-nav-link" href="/note">note</a> </li>
                
                  <li> <a class="main-nav-link" href="/software">software</a> </li>
                
                  <li><div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>


</div></li>
            </div>
          </div>
                
      </div>
    </div>

</header>



      
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="page-"  class="article article-type-page" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
    <div class="article-meta">
      
      
      
      

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <img src="/assets/img/bubblenetavatar.jpg">



<font size=3.9, color="black">


<center> 


<h1 id="BubbleNet"><a href="#BubbleNet" class="headerlink" title="BubbleNet"></a>BubbleNet</h1><p><em>A deep learning framework for inferring microbubble dynamics</em></p>
<p><a target="_blank" rel="noopener" href="https://hanfengzhai.net/">Hanfeng Zhai</a> &amp; <a target="_blank" rel="noopener" href="https://smes.shu.edu.cn/info/1033/1145.htm">Guohui Hu</a></p>
<p>[<a target="_blank" rel="noopener" href="https://github.com/hanfengzhai/BubbleNet">Code</a>] | [<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2105.07179">Paper</a>] | [<a target="_blank" rel="noopener" href="https://youtu.be/fKkvRyeWANM">Video</a>]</p>
</center>


<p><a target="_blank" rel="noopener" href="https://doi.org/10.5281/zenodo.4769081"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.4769081.svg"></a><a target="_blank" rel="noopener" href="https://arxiv.org/abs/2105.07179"><img src="http://img.shields.io/badge/physics.flu_dyn-arXiv%3A2105.07179-B31B1B.svg"></a></p>
<hr>
<h2 id="Backgrounds-amp-Introduction"><a href="#Backgrounds-amp-Introduction" class="headerlink" title="Backgrounds &amp; Introduction"></a>Backgrounds &amp; Introduction</h2><p>Machine learning (ML) has achieved tremendous success in the last decade due to the availability of big data and computer resources. The success of <a target="_blank" rel="noopener" href="https://deepmind.com/research/case-studies/alphago-the-story-so-far">AlphaGo</a> burst the public’s interest by showing the huge potential of machine learning and artificial intelligence. The ML techniques shows promising results, specifically in medicine, e.g., <a target="_blank" rel="noopener" href="https://deepmind.com/blog/article/AlphaFold-Using-AI-for-scientific-discovery">AlphaFold</a> for discovering protein structures, <a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7429815/">COVID-19 detections</a>, etc. both are becoming more significant in our aging societies. Deep neural networks (DNNs), as one of the most prominent tools of ML, have been adopted to tackle various physics problems including <a target="_blank" rel="noopener" href="https://arxiv.org/abs/1911.05718">turbulence</a>, <a target="_blank" rel="noopener" href="https://arxiv.org/abs/1905.10094?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%253A+arxiv%252FQSXk+%2528ExcitingAds%2521+cs+updates+on+arXiv.org%2529">flow control</a>, <a target="_blank" rel="noopener" href="https://link.springer.com/article/10.1007%2Fs10973-020-09875-6">heat transfer</a>, and <a target="_blank" rel="noopener" href="https://ideas.repec.org/a/eee/energy/v131y2017icp106-112.html">combustion</a>. These deep learning applications have grown drastically in recent years, mainly on learning physical equations and inferring dynamics. Numerous novel frameworks has henceforth been proposed: <a target="_blank" rel="noopener" href="https://www.pnas.org/content/113/15/3932">SINDy</a> and <a target="_blank" rel="noopener" href="https://advances.sciencemag.org/content/3/4/e1602614">PDE-FIND</a>, using sparse regression to identify the governing equations for nonlinear dynamic systems; <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2003.03485">Graph Kernel Network</a>, <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2010.08895">Fourier Neural Operator</a> and <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2005.01463">MeshfreeFlowNet</a>, using convolutional neural networks to learn image mapping the physics fields; <a target="_blank" rel="noopener" href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.120.143001">Deep potential</a>, <a target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/pii/S0010465518300882">DeePMD</a> and <a target="_blank" rel="noopener" href="https://aip.scitation.org/doi/10.1063/1.5027645">DeePCG</a>, using deep neural nets to map the molecular potentials at the microscale. In 2018, <a target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/pii/S0021999118307125">Raissi et al.</a> proposed a deep learning framework called physics-informed neural networks (<a target="_blank" rel="noopener" href="https://maziarraissi.github.io/PINNs/">PINNs</a>) for identifying and inferring dynamics of physical systems governed by partial differential equations (PDEs). The strategy of PINN can be simplified as embed governing PDEs into the loss function as a soft physics constraint, namely the ‘physics-informed’ part. Based on PINN, Lu et al. then proposed <a target="_blank" rel="noopener" href="https://epubs.siam.org/doi/abs/10.1137/19M1274067">DeepXDE</a> and <a target="_blank" rel="noopener" href="https://www.nature.com/articles/s42256-021-00302-5">DeepONet</a>, the refined versions of PINNs, for learning and inferring nonlinear operators of PDEs.</p>
<p>The PINN series has been developed to solve numerous problems, including <a target="_blank" rel="noopener" href="https://epubs.siam.org/doi/abs/10.1137/18M1229845">Fractional PINNs</a> for predicting fractional PDEs; <a target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/pii/S0045782520302127?via=ihub">Conservative PINNs</a> for nonlinear conservation laws; <a target="_blank" rel="noopener" href="http://www.global-sci.com/intro/article_detail/cicp/18403.html">Extended PINNs</a>, a PINN approach for space-time domain decomposition; <a target="_blank" rel="noopener" href="https://arxiv.org/abs/1909.10145">Parareal PINNs</a>, a PINN solver decomposing a long-time problem into many independent short-time problems supervised by an inexpensive/fast coarse-grained (CG) solver; and many related PINNs. Besides, PINNs has achieved great success for predicting <a target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/pii/S2095034920300350">laminar flows</a> and <a target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/pii/S0045782519306814?via=ihub">high speed flows</a>, <a target="_blank" rel="noopener" href="https://asmedigitalcollection.asme.org/heattransfer/article/143/6/060801/1104439/Physics-Informed-Neural-Networks-for-Heat-Transfer">heat transfer</a> and <a target="_blank" rel="noopener" href="https://www.kdd.org/kdd2020/accepted-papers/view/towards-physics-informed-deep-learning-for-turbulent-flow-prediction">turbulence</a>.</p>
<p>Bubbly flows is a classic fluid mechanics problem, specifically at the mesoscale. The bubble pinch-off effect confined in microtube is one of the most studied problems in fluid mechanics (<a target="_blank" rel="noopener" href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.100.034504">Dollet et al.</a>, <a target="_blank" rel="noopener" href="https://www.cambridge.org/core/journals/journal-of-fluid-mechanics/article/analysis-of-the-drippingjetting-transition-in-compound-capillary-jets/8209BF4D32F87E4647C181727FCDFA5B?__cf_chl_jschl_tk__=7d71e87cb91a5e24af707925bb66a7b98d6df963-1620896799-0-AfTf8hcALuYeTzPZeznSMLdPeSmC5klxfYdedAotMmdI4WtMuSHLwglLMFq5jB0L1mpqWsLOhrYiWWg0pSStjC89Am8TIRV4CLXRuH-v7bI6xUOwUbta2YaprNaeW9bBTdiDuZfrd1LlGolllLDUJ9C7Fd4vY-o7WxLfVzoeqPxvECoJtftkMNjv2iH92AoPjssWCDtDT2WACtB6EndbW8HdVitzDCig79GOIE1CQP7_spnBpwofgH9pNPvR18jADQ8HqMhlUycmrMGZF8m4cHDZlw9g9o1vBASD8zlAVQzGU_gOXp54sSt4OLdA4w8BouOqEjNz2Z6XWicM_oZJD7qZ4g3AGqaYTReXa-0pxVKKQ-SQfoG8i6p8c7wlVhBTFPaDFjEEI1c-TykKQqPPIXknB_Uu9mJ6Q81--QNc-1Zik0bAV7k7ytXL1JterhDczD-5kELTaT89tdloXiAVredGy4RTePPrEJ5yV6wN5QLrRH_NOD0_JgE-cEMjTwt7U4-52lbrBbSmMIHiA2gKujgcdRKihfJjyDuGYqGYdO7TdXx0vKD1DZ3XfxUgzGbNJkNIoKoxu6IkCD530O3AU4MM3gaovH8xUaao0dnC6PcDSqCESl2bFmPpf10ii3cwoj3vMRwl-r_GiAOWwuQcvWo">Herrada et al.</a>, <a target="_blank" rel="noopener" href="https://aip.scitation.org/doi/full/10.1063/1.3631323">van Hoeve et al.</a>, <a target="_blank" rel="noopener" href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.89.063012">Vega et al.</a>, <a target="_blank" rel="noopener" href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.120.084501">Zhao et al.</a>), depicting deformation and movement of single bubble dynamics. Single bubble movement has also been studied for investigating blood-brain barrier (<a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2677346/">Miao et al.</a>, <a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3765296/">Hosseinkhah et al.</a>, <a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4406873/">Hosseinkhah et al.</a>). Bubbly flow with multiple bubbles displays complexity due to the interactions between bubbles (<a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2556210/">Talu et al.</a>, <a target="_blank" rel="noopener" href="https://pubs.rsc.org/en/content/articlelanding/2019/ra/c9ra04212a#!divAbstract">Tenjimbayashi et al.</a>), which are also widely studied for drug delivery (<a target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/pii/S0001868614000293">Papadopoulou et al.</a>, <a target="_blank" rel="noopener" href="https://pubs.rsc.org/en/content/articlelanding/2012/lc/c2lc40634a#!divAbstract">Peyman et al.</a>).</p>
<p>Acknowledging the importance and numerous applications of bubbly flow, and realizing the powerful tool of physics based machine learning, we here apply machine learning to infer and predict the bubbly flow. Our work is inspired by <a target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/pii/S0021999118307125">Raissi et al.</a> and <a target="_blank" rel="noopener" href="https://aip.scitation.org/doi/full/10.1063/5.0041203">Lin et al.</a> using physics-informed deep learning to infer bubble dynamics. Different from <a target="_blank" rel="noopener" href="https://aip.scitation.org/doi/full/10.1063/5.0041203">Lin et al.</a>‘s approach, we do not adopt the theoretical model optimized for modeling bubble (i.e., the Rayleigh-Plesset equation). Instead, we directly compute how bubble moves through numerical simulations of multiphase flow. Based on <a target="_blank" rel="noopener" href="https://maziarraissi.github.io/PINNs/">PINNs</a>, we also propose a new deep learning architecture, called <strong>BubbleNet</strong>, which entails three main parts: deep neural networks (DNN) with sub nets for predicting different physics fields; the physics-informed part, with the fluid continuum condition encoded within; the time discretized normalizer (TDN), an algorithm to normalize field data per time step before training. We apply the traditional DNN and our BubbleNet to train the simulation data and predict the physics fields of both the two bubbly flow cases.</p>
<hr>
<h2 id="Methods-amp-Results"><a href="#Methods-amp-Results" class="headerlink" title="Methods &amp; Results"></a>Methods &amp; Results</h2><p>Two cases were set up for investigating the bubble flow: $^1$ single bubble flow and $^2$ multiple bubbles flow, confined in a microtube. For the single bubble case: the microbubble diameter is set to be $d = 4\mu \rm m$; the micro-tube has a length of 15$\mu$m and diameter of $5\mu \rm m$; we set up periodic boundary conditions (BCs) as $\Delta p = 10 \rm Pa$, and the tube is confined at the end as constant pressure $p = 799.932 \rm Pa$ (6mmHg), corresponding to the pressure in human interstitial fluid. the initial conditions (ICs) is set as the pressure $p_0 = 799.932Pa$, with room temperature as $293.15K$. For the multiple bubbles flow: 60 micro-bubbles are randomly distributed in a 2D micro-tube with a length of $100\mu \rm m$ and a diameter of $50 \mu \rm m$, with each micro-bubble of the diameter of $3\mu \rm m$. The BCs and ICs are same with the single bubble case: $ \Delta p = 10 \rm Pa$, constant pressure at tube end $p = 799.932 \rm Pa$ and $p_0 = 799.932 \rm Pa$, with room temperature as $293.15K$. Both the meshing of the two bubbly flows are set to be extremely fine. For a single bubble case, the simulation is run for $5000 \mu \rm s$, and for the multiple bubbles case, the simulation is run for $3000 \mu \rm s$.</p>
<video width="500" height="320" controls>
<source src="https://hanfengzhai.net/vid/sbubble.mp4">
</video>


<center>

<p><em>Simulation for the single bubble flow case.</em> </p>
</center>


<video width="500" height="320" controls>
<source src="https://hanfengzhai.net/vid/mbubble.mp4">
</video>


<center> 

<p><em>Simulation for the multiple bubbles flow case.</em></p>
</center>

<p>The basic structure of <strong>BubbleNet</strong> is shown in the following figure, as introduced previously.</p>
<img src="/assets/img/bubblenet.jpeg">

<p>Where we differenciate the latent function $\psi$ to compute the velocities $u$ and $v$:</p>
<p>$u = {\partial \psi \over \partial y},\  v = - {\partial \psi \over \partial x}$</p>
<p>We use the mean square error (MSE) for computing the loss function:</p>
<p>$L = MSE\left( u_{pred} - u_{train} + v_{pred} - v_{train} + … + \phi_{pred} - \phi_{train}\right)$</p>
<p>We used traditional deep neural network and our <strong>BubbleNet</strong> to predict the physics fields $u,\ v,\ p,\ \phi$, of bubbly flow. Here, we show the level set phase function $\phi$ prediction for both the bubbly flow of a single bubble and multiple bubbles are shown in the following figures, at $2000 \mu \rm s$ for the single bubble case and $1500 \mu \rm s$ for the single bubble case. Training for 10000 iterations for the single bubble case and 200000 iterations for the multiple bubbles case. Adopting the Adam optimizer and ‘L-BFGS-B’ optimization method.</p>
<img src="/assets/img/bubblenet-1.jpeg">

<img src="/assets/img/bubblenet-2.jpeg">

<hr>
<h2 id="Tutorial"><a href="#Tutorial" class="headerlink" title="Tutorial"></a>Tutorial</h2><p>BubbleNet is a deep learning package building on top of <a target="_blank" rel="noopener" href="https://www.tensorflow.org/">TensorFlow</a>, install tf before using BubbleNet:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install tensorflow</span><br></pre></td></tr></table></figure>
<p>To use BubbleNet, you first need to download the code through GitHub (on your customized directory):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/hanfengzhai/BubbleNet.git</span><br></pre></td></tr></table></figure>
<p>In our practice, we trained our NNs on <a target="_blank" rel="noopener" href="http://www.blsc.cn/">Beijing Super Cloud Computing Center</a>, (BLSC). We therefore offer bash files can be runned on both BLSC or your lab work station. Here, you can try out the single bubble case and train both the DNN and BubbleNet:</p>
<p><em>I. For BLSC users, please run</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sbatch SingleBubble_SuperComputing.sh</span><br></pre></td></tr></table></figure>
<p><em>II. If you are using the work station at your lab or home:</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash SingleBubble_WorkStation.sh</span><br></pre></td></tr></table></figure>
<p><em>III. Or just execute the py files directly:</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python bubble_DNN.py <span class="comment"># run it on traditional deep neural net</span></span><br><span class="line">python bubble_PhysNet.py <span class="comment"># run it on BubbleNet</span></span><br></pre></td></tr></table></figure>
<p>Similarly, training the bubbly flow with multiple bubbles case on NN, run:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sbatch MultiBubble_SuperComputing.sh <span class="comment"># for BLSC users</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash SingleBubble_WorkStation.sh <span class="comment"># customized for workstations</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># directly execute the python files</span></span><br><span class="line">python bubblesys_DNN.py <span class="comment"># run it on traditional deep neural net</span></span><br><span class="line">python bubblesys_PhysNet.py <span class="comment"># run it on BubbleNet</span></span><br></pre></td></tr></table></figure>
<p>After the training, you will see the losses callbacks on your command lines, &amp; the accuracy for the NNs. You will also see the saved files of both the DNN &amp; BubbleNet predictions in your directory. Open these ‘<em>.txt</em>‘ files with matlab and convert them into ‘<em>.mat</em>‘ numerical matrix files.</p>
<p>Then, execute the ‘<em>.m</em>‘ files to generate figures for the final results, either with <a target="_blank" rel="noopener" href="https://www.mathworks.com/products/matlab.html">MATLAB</a> or <a target="_blank" rel="noopener" href="https://www.gnu.org/software/octave/index">Octave</a>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">octave figure_preparation.m </span><br><span class="line">octave figure_generation.m </span><br></pre></td></tr></table></figure>

<p>Now, sort out all the figures and you’ve already utilize most of BubbleNet! :)</p>
<hr>
<h2 id="Tech-Details"><a href="#Tech-Details" class="headerlink" title="Tech Details"></a>Tech Details</h2><p>If you are a developer wishing to customize your own BubbleNet for predictions, please refer the simplified version of our DNN and BubbleNet algorithms:</p>
<p>I. for DNN, the algorithms can be simplified to</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DeepNeuralNet</span>(<span class="params">self, x, y, t, u, v, p, phi</span>)</span></span><br><span class="line">  (x, y, t, u, v, p, phi) = update(x, y, t, u, v, p, phi)</span><br><span class="line">  (weights, biases, layers) = self.InitializeNN(weights, biases, layers)</span><br><span class="line">  self.loss = MSE((u - u_pred)+(v - v_pred)+(p - p_pred)+(phil - phil_pred))</span><br><span class="line">  u_pred, v_pred = self.net_psi(x, y, t)</span><br><span class="line">  p_pred = self.net_p(x, y, t)</span><br><span class="line">  phil_pred = self.net_phil(x, y, t)</span><br><span class="line">  Adam: <span class="comment">#iterations</span></span><br><span class="line">  ’L-BFGS-B’: max iterations = <span class="number">500000</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">InitializeNN</span>(<span class="params">self, layers</span>)</span></span><br><span class="line"><span class="function">  ...</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">NeuralNet</span>(<span class="params">self, weights, biases</span>)</span></span><br><span class="line"><span class="function">  ...</span></span><br><span class="line">def net_u, net_v, net_p, net_phil(self, x, y, t)</span><br><span class="line">  ...</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Train</span>(<span class="params">self, iterations</span>)</span></span><br><span class="line"><span class="function">  ...</span></span><br><span class="line">def predict_u, predict_v, predict_p, predict_phil(self, iterations)</span><br><span class="line">  u_pred, v_pred, p_pred, phil_pred = self.sess.run(x, y, t)</span><br><span class="line"></span><br><span class="line">layers = [<span class="number">30</span> neurons X <span class="number">9</span> layers]</span><br><span class="line">(x_train, y_train, t_train, u_train, v_train, p_train, phil_train) = np.maxminscaler(singlebubbledata)</span><br><span class="line">model = DeepNeuralNet(x_train, y_train, t_train, u_train, v_train, p_train, phil_train)</span><br><span class="line">model.train(<span class="comment">#iterations)</span></span><br><span class="line">t_pred = <span class="comment">#target prediction time</span></span><br><span class="line">u_pred, v_pred, p_pred, phil_pred = model.predict(x, y, t) @ t_pred</span><br></pre></td></tr></table></figure>


<p>II. for BubbleNet, the algorithms can be simplified to</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BubbleNet</span>(<span class="params">self, x, y, t, u, v, p, phi</span>)</span></span><br><span class="line">  (x, y, t, u, v, p, phi) = update(x, y, t, u, v, p, phi)</span><br><span class="line">  (weights, biases, layers) = self.InitializeNN(weights, biases, layers)</span><br><span class="line">  self.loss = MSE((u - u_pred)+(v - v_pred)+(p - p_pred)+(phil - phil_pred))</span><br><span class="line">  u_pred = self.net_u(x, y, t)</span><br><span class="line">  v_pred = self.net_v(x, y, t)</span><br><span class="line">  p_pred = self.net_p(x, y, t)</span><br><span class="line">  phil_pred = self.net_phil(x, y, t)</span><br><span class="line">  Adam: <span class="comment">#iterations</span></span><br><span class="line">  ’L-BFGS-B’: max iterations = <span class="number">500000</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">InitializeNN</span>(<span class="params">self, layers</span>)</span></span><br><span class="line"><span class="function">  ...</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">NeuralNet</span>(<span class="params">self, weights, biases</span>)</span></span><br><span class="line"><span class="function">  ...</span></span><br><span class="line">def net_psi, net_p, net_phil(self, x, y, t)</span><br><span class="line">  psi = net_psi(x, y, t)</span><br><span class="line">  u = tf.gradients(psi, y)[<span class="number">0</span>]</span><br><span class="line">  v = - tf.gradients(psi, x)[<span class="number">0</span>]</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">return</span> u, v, p, phil</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Train</span>(<span class="params">self, iterations</span>)</span></span><br><span class="line"><span class="function">  ...</span></span><br><span class="line">def predict_u, predict_v, predict_p, predict_phil(self, iterations)</span><br><span class="line">  u_pred, v_pred, p_pred, phil_pred = self.sess.run(x, y, t)</span><br><span class="line"></span><br><span class="line">layers = [<span class="number">30</span> neurons X <span class="number">9</span> layers]</span><br><span class="line">(x_train, y_train, t_train, u_train, v_train, p_train, phil_train) = np.TDN(singlebubbledata)</span><br><span class="line">model = BubbleNet(x_train, y_train, t_train, u_train, v_train, p_train, phil_train)</span><br><span class="line">model.train(<span class="comment">#iterations)</span></span><br><span class="line">t_pred = <span class="comment">#target prediction time</span></span><br><span class="line">u_pred, v_pred, p_pred, phil_pred = model.predict(x, y, t) @ t_pred</span><br></pre></td></tr></table></figure>


<hr>
<h2 id="Reference-amp-Citation"><a href="#Reference-amp-Citation" class="headerlink" title="Reference &amp; Citation"></a>Reference &amp; Citation</h2><p>Please refer the following work if you wish to employ and customize BubbleNet:</p>
<blockquote>
<p>H. Zhai and G. Hu. (2021) Inferring micro-bubble dynamics with physics-informed deep learning. <em>arXiv Preprint</em>. <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2105.07179">arXiv:2105.07179</a></p>
</blockquote>
<p>For (La)TeX users, please refer:</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@misc&#123;zhai2021BubbleNet,</span><br><span class="line">  title=&#123;Inferring micro-bubble dynamics with physics-informed deep learning&#125;,</span><br><span class="line">  author=&#123;Zhai, Hanfeng and Hu, Guohui&#125;,</span><br><span class="line">  year=&#123;2021&#125;,</span><br><span class="line">  eprint=&#123;2105.07179&#125;,</span><br><span class="line">  archivePrefix=&#123;arXiv&#125;,</span><br><span class="line">  primaryClass=&#123;physics.flu-dyn&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@software&#123;zhai_hanfeng_2021_4769081,</span><br><span class="line">  author       = &#123;Zhai, Hanfeng&#125;,</span><br><span class="line">  title        = &#123;&#123;Data for BubbleNet code <span class="tag">\<span class="name">&amp;</span></span> micro-bubbles system </span><br><span class="line">                   dynamics simulation&#125;&#125;,</span><br><span class="line">  month        = mar,</span><br><span class="line">  year         = 2021,</span><br><span class="line">  publisher    = &#123;Zenodo&#125;,</span><br><span class="line">  doi          = &#123;10.5281/zenodo.4769081&#125;,</span><br><span class="line">  url          = &#123;https://doi.org/10.5281/zenodo.4769081&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<font size=2.5, color="black">
      
    </div>
    <footer class="article-footer">
      
      
      <div>
        <ul class="post-copyright">
          Copyright Hanfeng Zhai | <a target="_blank" rel="noopener" href="https://hanfengzhai.net/"> www.HanfengZhai.net </a>
         
        </ul>
<div>

      
      
      

    </footer>
  </div>
  
    
  
</article>

<!-- Table of Contents -->

</section>
        
      </div>
      
      <footer id="footer">
  



  <div class="container">
      	<div class="row">
	      <p> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/iTimeTraveler/hexo-theme-hiker" target="_blank">Hiker</a> </p>
	      
        <p id="copyRightEn"> &copy; 2021 Hanfeng Zhai, All Rights Reserved.</p>
	      
        <p> 86-18021027596 | <a href="mailto:Hanfeng.Zhai@outlook.com"> Hanfeng.Zhai@outlook.com </a> </p>
        
        <p> <a target="_blank" rel="noopener" href="https://www.researchgate.net/profile/Hanfeng_Zhai"> ResearchGate </a> | <a target="_blank" rel="noopener" href="https://www.linkedin.com/in/hanfengzhai/"> LinkedIn </a> | <a target="_blank" rel="noopener" href="https://www.facebook.com/profile.php?id=100023812350047"> Facebook </a> | <a target="_blank" rel="noopener" href="https://github.com/hanfengzhai"> GitHub </a> | <a target="_blank" rel="noopener" href="https://twitter.com/HanfengZhai"> Twitter </a> | <a target="_blank" rel="noopener" href="https://scholar.google.com/citations?user=S5jCDXcAAAAJ&hl=en"> Google Scholar </a> | <a target="_blank" rel="noopener" href="https://shu-cn.academia.edu/FrankZhai"> Academia </a> | <a target="_blank" rel="noopener" href="https://orcid.org/0000-0003-1511-7597"> ORCiD </a> | <a target="_blank" rel="noopener" href="https://space.bilibili.com/355677660"> BiliBili </a> | <a target="_blank" rel="noopener" href="https://www.youtube.com/channel/UCn7UKJez4SV9VkO8pNqI5Pw?view_as=subscriber"> YouTube </a> | <a target="_blank" rel="noopener" href="https://hanfengzhai.net/cn"> 中文版 </a>
        </p>


        <p> <a target="_blank" rel="noopener" href="https://smes.shu.edu.cn/"> School of Mechanics and Engineering Science</a>, <a target="_blank" rel="noopener" href="https://www.shu.edu.cn/"> Shanghai University </a> | 99 Shangda Rd., Shanghai 200444, PRC </p>

	      <a target="_blank" rel="noopener" href="https://info.flagcounter.com/x6ta"><img src="https://s11.flagcounter.com/count2/x6ta/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_10/viewers_0/labels_0/pageviews_0/flags_0/percent_0/" alt="Flag Counter" border="0"></a>



		</div>

		
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");
    var allheader = document.getElementById("allheader");

    wrapdiv.style.minHeight = document.body.offsetHeight + "px";
    if (allheader != null) {
      contentdiv.style.minHeight = document.body.offsetHeight - allheader.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    } else {
      contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    }
</script>




    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">hοme</a>
  
    <a href="/about" class="mobile-nav-link">abοut</a>
  
    <a href="/research" class="mobile-nav-link">research</a>
  
    <a href="/note" class="mobile-nav-link">Note</a>
  
    <a href="/software" class="mobile-nav-link">Software</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>




<script src="/js/scripts.js"></script>












	<div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>








  </div>

  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="myModalLabel">设置</h2>
      </div>
      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">


      <div class="modal-body">
          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" onclick="javascript:setFontSize();" aria-expanded="true" aria-controls="collapseOne">
              正文字号大小
            </a>
          </div>
          <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
          <div class="panel-body">
            您已调整页面字体大小
          </div>
        </div>
      


          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" onclick="javascript:setBackground();" aria-expanded="true" aria-controls="collapseTwo">
              夜间护眼模式
            </a>
        </div>
          <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
          <div class="panel-body">
            夜间模式已经开启，再次单击按钮即可关闭 
          </div>
        </div>

        <div>
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;关 于&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
        </div>
         <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
          <div class="panel-body">
            Hanfeng Zhai
          </div>
          <div class="panel-body">
            Copyright © 2021 Bachelor Student @ Shanghai University All Rights Reserved.
          </div>
        </div>
      </div>


      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <div class="modal-footer">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
      </div>
    </div>
  </div>
</div>
  
  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
  
</body>
</html>